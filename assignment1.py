# -*- coding: utf-8 -*-
"""assignment1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15S_APUQq4xpTqU_DMnAcmIqbdG74qac4
"""

import pandas as pd
from pygam import LinearGAM, s

# Load the training and test datasets
url = "https://github.com/dustywhite7/econ8310-assignment1/raw/main/assignment_data_train.csv"
url1 = "https://github.com/dustywhite7/econ8310-assignment1/raw/main/assignment_data_test.csv"
df = pd.read_csv(url)
df_test = pd.read_csv(url1)

# Process the Timestamp column
df['Timestamp'] = pd.to_datetime(df['Timestamp'])
df_test['Timestamp'] = pd.to_datetime(df_test['Timestamp'])

# Extract features from Timestamp
for data in [df, df_test]:
    data['year'] = data['Timestamp'].dt.year
    data['month'] = data['Timestamp'].dt.month
    data['day'] = data['Timestamp'].dt.day
    data['hour'] = data['Timestamp'].dt.hour
    data['day_of_week'] = data['Timestamp'].dt.dayofweek

# Prepare the training and test data
X_train = df[['hour', 'day_of_week', 'month', 'year']].values  # Convert to NumPy
y_train = df['trips'].values  # Convert to NumPy
X_test = df_test[['hour', 'day_of_week', 'month', 'year']].values  # Convert to NumPy

# Initialize and fit the GAM model
model = LinearGAM(s(0) + s(1) + s(2) + s(3))
modelFit = model.fit(X_train, y_train)

# Predict the number of trips
pred = modelFit.predict(X_test)

# Save the predictions in the test dataframe
df_test['trips'] = pred

# Print the number of predictions
print("Number of predictions:", len(pred))

# Show the first few rows of the test dataframe
df_test.head()

!pip install pygam